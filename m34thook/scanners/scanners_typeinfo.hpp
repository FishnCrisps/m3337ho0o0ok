located_feature_t descan::g_idtypeinfo_findclassinfo = 0, descan::g_idtypeinfo_findenuminfo = 0;
located_feature_t descan::g_idTypeInfoFile_readstr = 0;
located_feature_t descan::g_resourcelist_for_classname = 0, descan::g_listOfResourceLists = 0,
descan::g_serialize_type_to_json = 0;
located_feature_t descan::g_deserialize_type_from_json = 0, descan::g_global_typeinfo_tools = 0;
#if !defined(MH_ETERNAL_V6)
using scanner_locate_findclassinfo = memscanner_t<
/*	scanbytes<0x48, 0x89, 0x5c, 0x24, 0x20, 0x56, 0x48, 0x83, 0xec, 0x20, 0x48, 0x8b, 0xf2, 0x48, 0x8b, 0xd9, 0x48, 0x85, 0xd2, 0x0F, 0x84>,
	skip<4>,
	scanbytes<  0x80, 0x3A, 0x00, 0x0F, 0x84>,
	skip<4>,*/
	scanbytes<0x48, 0x89, 0x6c, 0x24, 0x30, 0x48, 0x8b, 0xca, 0x48, 0x89, 0x7c, 0x24, 0x38, 0x4c, 0x89, 0x74, 0x24, 0x40, 0xe8>,
	match_riprel32_to<&descan::g_idstr_hash>>;

#else
//this should work pre v6 as well

using scanner_locate_findclassinfo = memscanner_t<
	scanbytes<0x48,0x8d,0x15>,
	riprel32_data_equals<0x69, 0x64, 0x50, 0x61, 0x72, 0x74, 0x69, 0x63, 0x6C, 0x65, 0x50, 0x61, 0x72, 0x6D, 0x00>,
	scanbytes<0x48,0x8b,0xcf,0xe8>
>;

#endif
//141187E21
using scanner_locate_findenuminfo = memscanner_t<
	scanbytes<0x48, 0x8B, 0x0D>,
	match_riprel32_to<&descan::g_global_typeinfo_tools>,
	scanbytes<0x48, 0x8D, 0x15>,
	riprel32_data_equals<  0x69, 0x64, 0x41, 0x6E, 0x69, 0x6D, 0x61, 0x74, 0x65, 0x64,
	0x53, 0x69, 0x6D, 0x70, 0x6C, 0x65, 0x5F, 0x46, 0x61, 0x75,
	0x73, 0x74, 0x3A, 0x3A, 0x6E, 0x6F, 0x64, 0x65, 0x46, 0x6C,
	0x61, 0x67, 0x73, 0x5F, 0x74, 0x00>,
	scanbytes<0x48,0x8b,0xd8,0xe8>
>;
/*scanbytes<0xf,0xb6,0x11,0x33,0xc0,0x84,0xd2,0x74,0x1a,0xf,0x1f,0x80,0x0,0x0,0x0,0x0,0x6b,0xc0,0x1f,0x48,0x8d,0x49,0x1,0xf,0xb6,0xd2,0x3,0xc2,0xf,0xb6,0x11,0x84,0xd2,0x75,0xed,0xc3>*///>;

using scanner_locate_global_typeinfo_tools = memscanner_t<
	scanbytes<0x48, 0x8D, 0x15>,
	riprel32_data_equals<  0x64, 0x75, 0x72, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x5F, 0x74,
	0x00>,//duration_t
	scanbytes<0x48, 0x8B, 0x0D>>;


/*
	match using readresource in v1.0 at 141889400
	this could be potentially problematic because its such a long pattern,
	but theres only one call to the function and this is it
*/

using scanner_locate_resourcelist_for_classname = memscanner_t<
	scanbytes<0x48, 0x89, 0x5c, 0x24, 0x8, 0x48, 0x89, 0x74, 0x24, 0x18, 0x57, 0x48, 0x81, 0xec, 0x60, 0x1, 0x0, 0x0, 0x48, 0x8B, 5>,
	match_riprel32_to<&descan::g_security_cookie>,
	scanbytes<0x48, 0x33, 0xc4, 0x48, 0x89, 0x84, 0x24, 0x50, 0x1, 0x0, 0x0, 0x48, 0x8b, 0xb4, 0x24, 0xb0, 0x1, 0x0, 0x0, 0x48, 0x8d, 0x4c, 0x24, 0x20, 0x49, 0x8b, 0xf9, 0x48, 0x8b, 0xda,
	0xe8>,
	match_riprel32_to<&descan::g_idstr__idstr>,
	scanbytes<0x48, 0x8d, 0x44, 0x24, 0x50, 0xc6, 0x44, 0x24, 0x50, 0x0, 0x48, 0x89, 0x44, 0x24, 0x28, 0x48, 0x8d, 0x54, 0x24, 0x20, 0x8b, 0x44, 0x24, 0x34, 0x48, 0x8b, 0xcb, 0x25, 0x0, 0x1, 0x0, 0xc0, 0xc7, 0x44, 0x24, 0x30, 0x0, 0x0, 0x0, 0x0, 0xd,
	0x0, 0x1, 0x0, 0x80, 0x89, 0x44, 0x24, 0x34,
	0x48, 0x8d>,
	skip<5>,
	scanbytes<0x48, 0x89, 0x44, 0x24, 0x20, 0xe8>,
	skip_and_capture_rva<&descan::g_idTypeInfoFile_readstr>, //capturing this address, just because we can
	scanbytes<0x48, 0x8b, 0xcf, 0xe8>>/* rva after is the address of resourcelistforclassname */;

/*
	use scan function bounds on resourcelistforclassname
*/
using scanner_locate_listofResourceLists_and_idstricmp = memscanner_t<
	scanbytes<0x48, 0x89, 0x5c, 0x24, 0x8, 0x57, 0x48, 0x83, 0xec, 0x20,
	0x48, 0x8B, 0x1D>,
	skip_and_capture_rva<&descan::g_listOfResourceLists>,
	scanbytes<0x48, 0x8b, 0xf9, 0x48, 0x85, 0xdb, 0x74>,
	skip<1>,
	align_next<16>,
	scanbytes<0x48, 0x8b, 0x4b, 0x8, 0x48, 0x8b, 0xd7, 0x48, 0x8b, 0x49, 0x8, 0xe8>>;


/*
	problem : both the serializer and deserializer match this
*/

using scanner_locate_deserialize_typetojson = memscanner_t<
	scanbytes<0x40, 0x55, 0x53, 0x57, 0x41, 0x54, 0x41, 0x55, 0x41, 0x56, 0x41, 0x57, 0x48, 0x8d, 0x6c, 0x24, 0xe0, 0x48, 0x81, 0xec, 0x20, 0x1, 0x0, 0x0, 0x48, 0x8B, 0x05>,
	match_riprel32_to<&descan::g_security_cookie>,
	scanbytes<0x48, 0x33, 0xc4, 0x48, 0x89, 0x45, 0x0, 0x48, 0x8b, 0xbd, 0x80, 0x0, 0x0, 0x0, 0x4c, 0x8b, 0xf2, 0x48, 0x8b, 0x95, 0x90, 0x0, 0x0, 0x0, 0x41, 0x8b, 0xd9, 0x4c, 0x8b, 0xa5, 0x88, 0x0, 0x0, 0x0, 0x4d, 0x8b, 0xe8, 0x89, 0x5c, 0x24, 0x58, 0x4c, 0x8b, 0xf9, 0x48, 0x89, 0x7c, 0x24, 0x60, 0x48, 0x85, 0xd2, 0x74>,
	skip<1>,
	scanbytes<0x80, 0x3a, 0x0, 0x75>
>;

//g_declentitydef_setentitystate
using locate_setentitystate = memscanner_t<

	scanbytes<0x48, 0x85, 0xd2, 0xf, 0x84>,
	skip<4>,
	scanbytes<0x4c, 0x8b, 0xdc, 0x55, 0x57, 0x41, 0x56, 0x49, 0x8d, 0xab, 0x8, 0xff, 0xff, 0xff, 0x48, 0x81, 0xec, 0xe0, 0x1, 0x0, 0x0, 0x48, 0x8b, 5>,
	match_riprel32_to<&descan::g_security_cookie>,
	scanbytes<0x48, 0x33, 0xc4, 0x48, 0x89, 0x85, 0xb0, 0x0, 0x0, 0x0, 0x48, 0x8b, 0xf9, 0x49, 0x89, 0x5b, 0x18>>;
//0014041B2FC
using locate_getentitystate_in_body = memscanner_t<

	scanbytes<0x4c, 0x8b, 0x46, 0x78, 0x41, 0x80, 0x38, 0x0, 0x74>,
	skip<1>,
	scanbytes<0x48, 0x8D, 0x15>,
	riprel32_data_equals<  0x69, 0x6E, 0x68, 0x65, 0x72, 0x69, 0x74, 0x20, 0x3D, 0x20,  //inherit = "%s";
	0x22, 0x25, 0x73, 0x22, 0x3B, 0x0A, 0x00>>;
